# Lesson 1: Hybrid Approach Introduction

## Tujuan
- Understand why hybrid approach (MediaPipe + DeepFace)
- Setup DeepFace dengan Facenet512 model
- Generate face encodings dari database
- Compare accuracy: Basic (MediaPipe) vs Hybrid

## Why Hybrid?

### Performance Comparison

| Method | Detection Speed | Recognition Accuracy | Real-time? |
|--------|----------------|---------------------|-----------|
| **MediaPipe only** (Week 3) | 10-15ms ‚ö° | ~85% ‚ö†Ô∏è | ‚úÖ Yes (30+ FPS) |
| **DeepFace only** | 150-200ms ‚ö†Ô∏è | 97%+ ‚úÖ | ‚ùå No (5 FPS) |
| **Hybrid** (Week 5) | 110-165ms üöÄ | 97%+ ‚úÖ | ‚úÖ Yes (6-9 FPS) |

### Best of Both Worlds
- **MediaPipe:** Fast detection (10-15ms)
- **DeepFace:** Accurate recognition (97%+)
- **Combined:** Real-time + Production-grade accuracy

## Face Encoding

### What is Face Encoding?
- 512-dimensional numerical vector (embedding)
- Represents unique facial features
- Generated by DeepFace Facenet512 model
- Used for comparing faces (similarity)

### How It Works
```
Face Image ‚Üí DeepFace Model ‚Üí 512-d Vector ‚Üí Store to Database

Example encoding:
[0.234, -0.456, 0.789, ..., 0.123]  # 512 numbers
```

## Files
1. **`encoding_generator.py`** - Generate encodings with DeepFace
2. **`main.py`** - Complete workflow (load from DB ‚Üí generate encodings)

## Yang Dipelajari
1. Install DeepFace dependencies (tensorflow, deepface)
2. Load persons from database (Week 4)
3. Generate face encodings with Facenet512
4. Store encodings to `face_encodings` table
5. Measure encoding time & accuracy
6. Compare with MediaPipe-only approach

## Prerequisites
```bash
# Install DeepFace (if not installed)
pip install deepface==0.0.89
pip install tensorflow==2.15.0
pip install tf-keras==2.15.0
```

**Local Dataset:**
- Dataset folder dengan person images (check `dataset/` folder)
- Minimal 1 person dengan 3+ images
- Images format: JPG atau PNG
- Check README di dataset folder untuk cara populate

**Cek Dataset:**
```bash
# Check person folders
Get-ChildItem dataset -Directory

# Count images
Get-ChildItem dataset\* -Include *.jpg,*.png -Recurse | Measure-Object | Select-Object -ExpandProperty Count
```

## Cara Menjalankan

### Step 1: Persiapan Dataset
```bash
# Masuk ke folder lesson 1
cd minggu-5-recognition-system\learning\lesson-1

# Pilih salah satu cara populate dataset:

# OPTION A: Copy dari Week 4
Copy-Item ..\..\..\minggu-4-dataset-database\project\dataset\* dataset\ -Recurse -Force

# OPTION B: Gunakan camera helper
cd c:\Ngoding\Kerja\ExtraQueensya
python camera_helper.py
Move-Item captured_faces\* minggu-5-recognition-system\learning\lesson-1\dataset\ -Force
cd minggu-5-recognition-system\learning\lesson-1
```

### Step 2: Verifikasi Dataset
```bash
# Check apakah ada person folders
Get-ChildItem dataset -Directory

# Count total images
(Get-ChildItem dataset\* -Include *.jpg,*.png -Recurse).Count
```

### Step 3: Install Dependencies (jika belum)
```bash
pip install deepface==0.0.89 tensorflow==2.15.0 tf-keras==2.15.0
```

### Step 4: Jalankan Encoding Generator
```bash
python main.py
```

### Step 5: Verifikasi Output
```bash
# Check output files created
Test-Path output\encodings.pkl
Test-Path output\metadata.json

# View metadata
Get-Content output\metadata.json
```

## Langkah
1. **Populate dataset folder** (see `dataset/README.md` for options)
2. **Check dataset**: Pastikan ada minimal 1 person folder dengan images
3. **Run encoding generator**: `python main.py`
4. **Wait for model download** (first run only, ~100MB Facenet512 model)
5. **Check encodings di HeidiSQL**: 
   - Refresh database
   - Buka table `face_encodings`
   - Lihat encoding_data (BLOB) untuk setiap person

## Output
```
üîß Loading DeepFace model: Facenet512
‚úÖ Model loaded! (size: 512-d embeddings)

üìä Loading persons from database...
‚úÖ Found 2 persons with 40 total images

üéØ Generating encodings...
   Person: Alice (EMP0001)
      Image 1/20: ‚úÖ Encoded (0.142s)
      Image 2/20: ‚úÖ Encoded (0.138s)
      ...
   ‚úÖ Alice: 20/20 encodings generated

   Person: Bob (EMP0002)
      ...
   ‚úÖ Bob: 20/20 encodings generated

‚úÖ COMPLETE!
Total encodings: 40
Average time: 0.145s per image
Database updated: face_encodings table

üí° Next: Lesson 2 - Recognition Service with hybrid approach!
```

## DeepFace Models (Optional)

| Model | Embedding Size | Accuracy | Speed |
|-------|---------------|----------|-------|
| **Facenet512** (Default) | 512-d | 97.3% | Medium |
| ArcFace | 512-d | 99.4% | Slower |
| SFace | 128-d | 95.2% | Faster |
| VGG-Face | 4096-d | 95.7% | Slow |

**Recommendation:** Stick with Facenet512 (best balance)

## Why This Matters
- **Production accuracy:** 97%+ vs 85% MediaPipe-only
- **Real-time capable:** 6-9 FPS vs 5 FPS pure DeepFace
- **Scalable:** Encodings stored once, compared millions of times
- **Industry standard:** Used by Facebook, Google, Microsoft

## Next: Lesson 2
Build **RecognitionService** dengan real-time webcam recognition!
